{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-08-29T10:26:27.097011Z", "invocation_id": "5f3631ca-a696-4328-80a5-fadd9044c2eb", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-29T10:26:26.917819Z", "completed_at": "2025-08-29T10:26:26.926113Z"}, {"name": "execute", "started_at": "2025-08-29T10:26:26.926621Z", "completed_at": "2025-08-29T10:26:27.023611Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10751485824584961, "adapter_response": {"_message": "SELECT 17", "code": "SELECT", "rows_affected": 17}, "message": "SELECT 17", "failures": null, "unique_id": "model.weather_dbt.stg_weather_data", "compiled": true, "compiled_code": "\n\nwith weather_data as (\nselect \nlocation_name,\nlocation_country,\nlocation_region,\nlatitude,\nlongitude,\ntimezone_id,\nobservation_timestamp,\ncurrent_temperature_celsius as temperature_c,\nweather_description,\nhumidity_percentage as humidity_pct,\nwind_speed_kmh as wind_speed_kmh,\npressure_mb as pressure_mb,\nprecipitation_mm as precip_mm,\nvisibility_km as visibility_km,\nuv_index,\nair_quality_co,\nair_quality_no2,\nair_quality_o3,\nair_quality_so2,\nair_quality_pm2_5,\nair_quality_pm10,\nair_quality_us_epa_index,\nair_quality_gb_defra_index,\nCAST(created_at as Date) as created_at,\nROW_NUMBER() OVER (PARTITION BY location_name, observation_timestamp ORDER BY observation_timestamp desc) as row_num\nfrom \"weather_data\".\"weather_api\".\"weather_api_raw_data\"\n)\nselect \n    location_name,\n    location_country,\n    location_region,\n    latitude,\n    longitude,\n    timezone_id,\n    observation_timestamp,\n    temperature_c,\n    weather_description,\n    humidity_pct,\n    wind_speed_kmh,\n    pressure_mb,\n    precip_mm,\n    visibility_km,\n    uv_index,\n    air_quality_co,\n    air_quality_no2,\n    air_quality_o3,\n    air_quality_so2,\n    air_quality_pm2_5,\n    air_quality_pm10,\n    air_quality_us_epa_index,\n    air_quality_gb_defra_index,\n    created_at\nfrom weather_data \nwhere row_num = 1", "relation_name": "\"weather_data\".\"weather_api\".\"stg_weather_data\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-29T10:26:27.031532Z", "completed_at": "2025-08-29T10:26:27.036316Z"}, {"name": "execute", "started_at": "2025-08-29T10:26:27.037139Z", "completed_at": "2025-08-29T10:26:27.078861Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04904055595397949, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.weather_dbt.weather_analytics", "compiled": true, "compiled_code": "\n\nwith weather_data as (\n    select \n        location_name,\n        case when location_name = 'Delhi' and location_country <> 'India'\n             then 'India' else location_country end as location_country,\n        case when location_name = 'Delhi' and location_country <> 'India'\n             then 'New Delhi' else location_region end as location_region,\n        round(avg(temperature_c)::numeric, 2) as avg_temperature_c,\n        round(avg(humidity_pct)::numeric, 2) as avg_humidity_pct,\n        round(avg(wind_speed_kmh)::numeric, 2) as avg_wind_speed_kmh,\n        round(avg(pressure_mb)::numeric, 2) as avg_pressure_mb,\n        round(avg(precip_mm)::numeric, 2) as avg_precip_mm,\n        round(avg(visibility_km)::numeric, 2) as avg_visibility_km,\n        round(avg(uv_index)::numeric, 2) as avg_uv_index,\n        round(avg(air_quality_co)::numeric, 2) as avg_air_quality_co,\n        round(avg(air_quality_no2)::numeric, 2) as avg_air_quality_no2,\n        round(avg(air_quality_o3)::numeric, 2) as avg_air_quality_o3,\n        round(avg(air_quality_so2)::numeric, 2) as avg_air_quality_so2,\n        round(avg(air_quality_pm2_5)::numeric, 2) as avg_air_quality_pm2_5,\n        round(avg(air_quality_pm10)::numeric, 2) as avg_air_quality_pm10,\n        round(avg(air_quality_us_epa_index)::numeric, 2) as avg_air_quality_us_epa_index,\n        round(avg(air_quality_gb_defra_index)::numeric, 2) as avg_air_quality_gb_defra_index,\n        max(observation_timestamp) as last_observed_at,\n        count(*) as record_count\n    from \"weather_data\".\"weather_api\".\"stg_weather_data\"\n    group by \n        location_name,\n        case when location_name = 'Delhi' and location_country <> 'India'\n             then 'India' else location_country end,\n        case when location_name = 'Delhi' and location_country <> 'India'\n             then 'New Delhi' else location_region end\n)  \nselect * from weather_data", "relation_name": "\"weather_data\".\"weather_api\".\"weather_analytics\"", "batch_results": null}], "elapsed_time": 0.3298461437225342, "args": {"full_refresh": true, "log_level_file": "debug", "macro_debugging": false, "require_resource_names_without_spaces": false, "log_format": "default", "write_json": true, "introspect": true, "skip_nodes_if_on_run_start_fails": false, "strict_mode": false, "profiles_dir": "/opt/dbt/profiles", "defer": false, "exclude_resource_types": [], "show": false, "require_batched_execution_for_custom_microbatch_strategy": false, "quiet": false, "vars": {}, "require_nested_cumulative_type_params": false, "use_colors": true, "state_modified_compare_vars": false, "show_resource_report": false, "use_colors_file": true, "resource_types": [], "warn_error_options": {"include": [], "exclude": []}, "which": "build", "cache_selected_only": false, "exclude": [], "version_check": true, "static_parser": true, "log_path": "/opt/dbt/logs", "log_file_max_bytes": 10485760, "populate_cache": true, "require_yaml_configuration_for_mf_time_spines": false, "partial_parse_file_diff": true, "log_format_file": "debug", "include_saved_query": false, "log_level": "info", "invocation_command": "dbt build --full-refresh --select stg_weather_data weather_analytics", "project_dir": "/opt/dbt", "source_freshness_run_project_hooks": false, "partial_parse": true, "printer_width": 80, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "print": true, "export_saved_queries": false, "select": ["stg_weather_data", "weather_analytics"], "state_modified_compare_more_unrendered_values": false, "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "favor_state": false}}